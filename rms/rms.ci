node {
	stage('prepare for build'){
		parallel {
			clean_db:{
				make db_clear_test
			}
			install_deps:{
				make deps
			}
			create_thrift_stub:{
				make thrift_auth
				make thrift_student
				make thrift_admin
			}
			make db_prepare_test
		}
	}
	stage('run test'){
		echo "try test multi times"
		make test
		make test
		make test
		make test
	}
	stage('build'){
		make build
	}
}
